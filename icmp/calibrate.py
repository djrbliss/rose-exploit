#!/usr/bin/python

import sys
import subprocess
import socket
import struct
import re

if (len(sys.argv) != 3):
	print "Usage: calibrate [IP] [PORT]"
	sys.exit(1)

ip = sys.argv[1]
port = sys.argv[2]

hexport = "0x%.08x" % (socket.htons(int(port)) << 16 | 2) 

decip = struct.unpack('L',socket.inet_aton(ip))[0]
hexip = "0x%.08x" % decip

f = open("connect.S", "r")
data = f.read()
f.close()

data = re.sub("set PORT,.*", "set PORT," + hexport, data, 1)
data = re.sub("set IP,.*", "set IP," + hexip, data, 1)

f = open("connect.S", "w")
f.truncate()
f.write(data)
f.close()
